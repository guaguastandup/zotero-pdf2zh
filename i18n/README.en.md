<div align="center">

![Zotero PDF2zh](./favicon@0.5x.svg)

<h2 id="title">Zotero PDF2zh</h2>

[![zotero target version](https://img.shields.io/badge/Zotero-8-blue?style=flat-square&logo=zotero&logoColor=CC2936)](https://www.zotero.org/download/)
[![Using Zotero Plugin Template](https://img.shields.io/badge/Using-Zotero%20Plugin%20Template-blue?style=flat-square&logo=github)](https://github.com/windingwind/zotero-plugin-template)
![Downloads release](https://img.shields.io/github/downloads/guaguastandup/zotero-pdf2zh/total?color=yellow)
[![License](https://img.shields.io/github/license/guaguastandup/zotero-pdf2zh)](https://github.com/guaguastandup/zotero-pdf2zh/blob/main/LICENSE)
[![zread](https://img.shields.io/badge/Ask_Zread-_.svg?style=flat&color=00b0aa&labelColor=000000&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQuOTYxNTYgMS42MDAxSDIuMjQxNTZDMS44ODgxIDEuNjAwMSAxLjYwMTU2IDEuODg2NjQgMS42MDE1NiAyLjI0MDFWNC45NjAxQzEuNjAxNTYgNS4zMTM1NiAxLjg4ODEgNS42MDAxIDIuMjQxNTYgNS42MDAxSDQuOTYxNTZDNS4zMTUwMiA1LjYwMDEgNS42MDE1NiA1LjMxMzU2IDUuNjAxNTYgNC45NjAxVjIuMjQwMUM1LjYwMTU2IDEuODg2NjQgNS4zMTUwMiAxLjYwMDEgNC45NjE1NiAxLjYwMDFaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00Ljk2MTU2IDEwLjM5OTlIMi4yNDE1NkMxLjg4ODEgMTAuMzk5OSAxLjYwMTU2IDEwLjY4NjQgMS42MDE1NiAxMS4wMzk5VjEzLjc1OTlDMS42MDE1NiAxNC4xMTM0IDEuODg4MSAxNC4zOTk5IDIuMjQxNTYgMTQuMzk5OUg0Ljk2MTU2QzUuMzE1MDIgMTQuMzk5OSA1LjYwMTU2IDE0LjExMzQgNS42MDE1NiAxMy43NTk5VjExLjAzOTlDNS42MDE1NiAxMC42ODY0IDUuMzE1MDIgMTAuMzk5OSA0Ljk2MTU2IDEwLjM5OTlaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik0xMy43NTg0IDEuNjAwMUgxMS4wMzg0QzEwLjY4NSAxLjYwMDEgMTAuMzk4NCAxLjg4NjY0IDEwLjM5ODQgMi4yNDAxVjQuOTYwMUMxMC4zOTg0IDUuMzEzNTYgMTAuNjg1IDUuNjAwMSAxMS4wMzg0IDUuNjAwMUgxMy43NTg0QzE0LjExMTkgNS42MDAxIDE0LjM5ODQgNS4zMTM1NiAxNC4zOTg0IDQuOTYwMVYyLjI0MDFDMTQuMzk4NCAxLjg4NjY0IDE0LjExMTkgMS42MDAxIDEzLjc1ODQgMS42MDAxWiIgZmlsbD0iI2ZmZiIvPgo8cGF0aCBkPSJNNCAxMkwxMiA0TDQgMTJaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00IDEyTDEyIDQiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K&logoColor=ffffff)](https://zread.ai/guaguastandup/zotero-pdf2zh)

Use [PDF2zh](https://github.com/Byaidu/PDFMathTranslate) and [PDF2zh_next](https://github.com/PDFMathTranslate/PDFMathTranslate-next) in Zotero for PDF translation

Version v3.0.36 | [Old version v2.4.3](./2.4.3%20version/README.md)

**üìù Available Languages:** [English](README.en.md) | [Êó•Êú¨Ë™û](README.ja.md) | [ÌïúÍµ≠Ïñ¥](README.ko.md) | [Italiano](README.it.md) | [Fran√ßais](README.fr.md)

> **Note:** This translation was generated by AI and may contain inaccuracies. For the most accurate information, please refer to the [original Chinese version](README.md).

</div>


# How to Use This Plugin

This guide will walk you through the installation and configuration of the Zotero PDF2zh plugin.

‚ùì Need Help?

- Go to the FAQ: [FAQ](#frequently-asked-questions-faq)
- Ask basic questions (like how to install Python, conda, etc.) to AI
- Ask in GitHub Issues
- Join QQ Group: Group 5: 1064435415 (Answer: github)

# Installation Guide

## Step 0: Install Python and Zotero

- [Python Download Link](https://www.python.org/downloads/) - Version 3.12.0 recommended

- Plugin supports [Zotero 8](https://www.zotero.org/download/)

- Open terminal/cmd (Windows users use **Administrator** mode for cmd.exe)

## Step 1: Install uv/conda

**uv Installation (Recommended)**

1. Install uv
```shell
# Method 1: Script installation (recommended)
# macOS/Linux
wget -qO- https://astral.sh/uv/install.sh | sh
# Windows
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"

# Method 2: pip installation
pip install uv
```

2. Verify uv installation
```shell
# If uv version is displayed, installation is complete
uv --version
```

**conda Installation**

1. Install conda following: https://www.anaconda.com/docs/getting-started/miniconda/install#windows-command-prompt

2. Verify conda installation
```shell
conda --version
```

## Step 2: Download Project Files

```shell
# 1. Create and enter zotero-pdf2zh folder
mkdir zotero-pdf2zh && cd zotero-pdf2zh

# 2. Download and extract server folder
wget https://raw.githubusercontent.com/guaguastandup/zotero-pdf2zh/refs/heads/main/server.zip
unzip server.zip

# 3. Enter server folder
cd server
```

## Step 3: Prepare Environment and Run

1. **Install dependencies**
```shell
pip install -r requirements.txt
```

2. **If using conda**
```shell
python server.py --env_tool=conda
```

3. **If using uv (default)**
```shell
python server.py
```

Keep the script running while translating. Default options:
- Virtual environment management enabled
- uv as virtual environment tool
- Auto check for updates
- Default port: **8890**

## Step 4: Download and Install Plugin

Download v3.0.37 [here](https://github.com/guaguastandup/zotero-pdf2zh/releases/download/v3.0.37/zotero-pdf-2-zh.xpi)

In Zotero, open "Tools ‚Üí Plugins", drag the xpi file to install. Restart Zotero if needed.

## Step 5: Zotero Plugin Settings

**Configuration Options**

- Switch between `pdf2zh`/`pdf2zh_next` translation engines
- Configure **qps** and **poolsize** based on your service provider
- Custom fonts for pdf2zh engine

**Translation Services**

| Service Type | Service Name | Description |
|--------------|--------------|-------------|
| Free & No Config | siliconflowfree | Based on SiliconFlow's GLM4-9B model (pdf2zh_next only) |
| Free & No Config | bing/google | Official machine translation |
| Discounted | openaliked | Volcano Engine collaboration plan - 500k tokens/day |
| Discounted | silicon | Invite rewards available |
| High Quality | deepseek | Good translation, cache mechanism |
| High Quality | aliyunDashScope | Good results, new user bonuses |

## Step 6: Translation Options

Right-click on entry/PDF in Zotero, select PDF2zh translation option.

Options:
- **Translate PDF**: Generate translated PDF
- **Crop PDF**: Crop and stitch for mobile reading
- **Compare PDF**: Side-by-side original and translation
- **Crop-Compare PDF**: For dual-column PDFs

## Step 7: Package Updates (New)

Both plugin and server support auto-update. For manual updates:

1. Enter virtual environment
2. Run: `pip install --upgrade pdf2zh_next babeldoc` (conda) or `uv pip install --upgrade pdf2zh_next babeldoc` (uv)

# Frequently Asked Questions (FAQ)

### About Virtual Environment

**Q: uv/conda installation failed, can I skip virtual environment?**

A: If you only use one engine and have Python 3.12.0 globally, you can disable virtual environment management:
```shell
python server.py --enable_venv=False
```

### About Network

**Q: NetworkError when attempting to fetch resource?**

A:
- Ensure plugin is version 3.0.x
- Keep server.py running
- Check if port 8890 is occupied
- Try switching ports
- Check firewall and antivirus

**Q: Translation stuck at certain point?**

A: pdf2zh_next downloads assets on first run. This is slow. You can download the exe package and run once to cache assets.

### About Environment

**Q: DLL initialization routine failed?**

A:
- Downgrade onnx package to version `1.16.1` in virtual environment
- Try installing vs_redist.x86.exe instead of x64
- For macOS old versions, use Python 3.11 instead of 3.12

### About Remote Services

**Q: Can I use without API configuration?**

A: Only free services like siliconflowfree or bing/google work without API.

**Q: Too many tokens consumed?**

A: A 10-page paper typically consumes 70-100k tokens. Try disabling terminology extraction in pdf2zh_next settings.

### About Plugin Features

**Q: Scanned PDF detected, translation failed?**

A: The plugin doesn't provide OCR. Use other tools to OCR your scanned PDF first.

### About Asking Questions

**Q: How to troubleshoot effectively?**

A:
- Read the guide carefully
- Copy terminal output to txt
- Screenshot Zotero settings
- Share all three in QQ group with: what you've checked, methods tried, tutorials watched

# Acknowledgments

- @Byaidu [PDF2zh](https://github.com/Byaidu/PDFMathTranslate)
- @awwaawwa [PDF2zh_next](https://github.com/PDFMathTranslate-next/PDFMathTranslate-next)
- @windingwind [zotero-plugin-template](https://github.com/windingwind/zotero-plugin-template)
- [Immersive Translate](https://immersivetranslate.com) for sponsoring Pro memberships

# Contributors

Thanks to all contributors!

<a href="https://github.com/guaguastandup/zotero-pdf2zh/graphs/contributors"> <img src="https://contrib.rocks/image?repo=guaguastandup/zotero-pdf2zh" /></a>

# How to Support Me

üíê Free and open-source plugin, your support keeps me going!

- ‚òïÔ∏è [Buy me a coffee (WeChat/Alipay)](https://github.com/guaguastandup/guaguastandup)
- üê≥ [AiDian](https://afdian.com/a/guaguastandup)
- ü§ñ [SiliconFlow Invite](https://cloud.siliconflow.cn/i/WLYnNanQ)

# Star History

[![Star History Chart](https://api.star-history.com/svg?repos=guaguastandup/zotero-pdf2zh&type=Date)](https://www.star-history.com/#guaguastandup/zotero-pdf2zh&Date)
