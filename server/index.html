<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDFç¿»è¯‘æœåŠ¡ - ç¿»è¯‘è¿›åº¦ç›‘æ§</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
          Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        color: #333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      .header {
        background: white;
        border-radius: 12px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }
      .header h1 {
        color: #667eea;
        font-size: 32px;
        margin-bottom: 10px;
      }
      .header p {
        color: #666;
        font-size: 14px;
      }

      /* çŠ¶æ€å¡ç‰‡ */
      .status-card {
        background: white;
        border-radius: 12px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }
      .status-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 25px;
      }
      .status-title {
        font-size: 20px;
        font-weight: 600;
        color: #333;
      }
      .status-subtitle {
        margin-top: 6px;
        font-size: 12px;
        color: #888;
      }
      .status-actions {
        display: flex;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
        justify-content: flex-end;
      }

      /* ä»»åŠ¡ç­›é€‰åˆ†æ®µæŒ‰é’® */
      .segmented {
        display: inline-flex;
        background: #f0f2ff;
        border: 1px solid #dfe5ff;
        border-radius: 10px;
        overflow: hidden;
      }
      .seg-btn {
        border: none;
        background: transparent;
        padding: 8px 12px;
        font-size: 12px;
        font-weight: 700;
        color: #5568d3;
        cursor: pointer;
        transition:
          background 0.2s ease,
          color 0.2s ease;
      }
      .seg-btn:hover {
        background: rgba(102, 126, 234, 0.12);
      }
      .seg-btn.active {
        background: #667eea;
        color: #fff;
      }

      /* çŠ¶æ€å¾½ç«  */
      .status-badge {
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 600;
        text-transform: uppercase;
      }
      .status-badge.active {
        background: #e3fcef;
        color: #00a86b;
      }
      .status-badge.idle {
        background: #f0f0f0;
        color: #666;
      }
      .status-badge.error {
        background: #ffebee;
        color: #c62828;
      }
      .status-badge.success {
        background: #e8f5e9;
        color: #2e7d32;
      }

      /* è¿›åº¦æ¡ */
      .progress-container {
        margin-bottom: 15px;
      }
      .progress-bar-bg {
        width: 100%;
        height: 12px;
        background: #e0e0e0;
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 10px;
      }
      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        transition: width 0.3s ease;
        border-radius: 6px;
      }
      .progress-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .progress-text {
        font-size: 24px;
        font-weight: 700;
        color: #667eea;
      }
      .elapsed-time {
        font-size: 14px;
        color: #666;
        font-weight: 600;
        background: #f0f0f0;
        padding: 4px 10px;
        border-radius: 4px;
      }

      /* ä¿¡æ¯ç½‘æ ¼ */
      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }
      .info-item {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid #667eea;
      }
      .info-label {
        font-size: 12px;
        color: #666;
        margin-bottom: 5px;
        text-transform: uppercase;
      }
      .info-value {
        font-size: 16px;
        font-weight: 600;
        color: #333;
        word-break: break-all;
      }

      /* æ¶ˆæ¯æ¡† */
      .message-box {
        background: #fff3cd;
        border: 1px solid #ffc107;
        border-radius: 8px;
        padding: 15px;
        margin-top: 15px;
        display: none;
      }
      .message-box.error {
        background: #ffebee;
        border-color: #c62828;
      }
      .message-box.success {
        background: #e8f5e9;
        border-color: #2e7d32;
      }
      .message-text {
        color: #856404;
        font-size: 14px;
      }
      .message-box.error .message-text {
        color: #c62828;
      }
      .message-box.success .message-text {
        color: #2e7d32;
      }

      /* å†å²è®°å½•éƒ¨åˆ† */
      .history-section {
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }
      .history-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 25px;
      }
      .history-title {
        font-size: 20px;
        font-weight: 600;
        color: #333;
      }

      /* å¤šä»»åŠ¡åˆ—è¡¨æ ·å¼ */
      .tasks-container {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }
      .task-card {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 20px;
        border-left: 4px solid #667eea;
        transition: all 0.3s;
      }
      .task-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      .task-card.completed {
        border-left-color: #2e7d32;
      }
      .task-card.failed {
        border-left-color: #c62828;
      }

      .task-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }
      .task-filename {
        font-size: 16px;
        font-weight: 600;
        color: #333;
      }
      .task-badge {
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
      }
      .task-badge.active {
        background: #e3fcef;
        color: #00a86b;
      }
      .task-badge.completed {
        background: #e8f5e9;
        color: #2e7d32;
      }
      .task-badge.failed {
        background: #ffebee;
        color: #c62828;
      }

      .task-progress-bar {
        width: 100%;
        height: 8px;
        background: #e0e0e0;
        border-radius: 4px;
        overflow: hidden;
      }
      .task-progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        transition: width 0.3s ease;
      }

      .task-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
        margin-top: 12px;
        font-size: 13px;
      }
      .task-info-item {
        display: flex;
        flex-direction: column;
      }
      .task-info-label {
        color: #666;
        font-size: 11px;
        margin-bottom: 2px;
      }
      .task-info-value {
        color: #333;
        font-weight: 500;
      }

      .task-message {
        margin-top: 10px;
        padding: 8px 12px;
        background: #fff3cd;
        border-radius: 6px;
        font-size: 13px;
        display: none;
      }
      .task-message.error {
        background: #ffebee;
        color: #c62828;
      }
      .task-message.success {
        background: #e8f5e9;
        color: #2e7d32;
      }

      .btn {
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        transition: background 0.3s;
      }
      .refresh-btn {
        background: #667eea;
        color: white;
      }
      .refresh-btn:hover {
        background: #5568d3;
      }
      .clear-btn {
        background: #e57373;
        color: white;
        margin-left: 10px;
      }
      .clear-btn:hover {
        background: #d32f2f;
      }

      .history-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      /* å†å²æ¡ç›®æ ·å¼ (æ”¯æŒæŠ˜å ) */
      .history-item {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 15px 20px;
        border-left: 4px solid #667eea;
        cursor: pointer;
        transition: all 0.2s;
      }
      .history-item:hover {
        transform: translateX(5px);
        background: #f1f3f5;
      }
      .history-item.failed {
        border-left-color: #c62828;
      }
      .history-item.success {
        border-left-color: #2e7d32;
      }

      .history-summary {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .history-filename {
        font-size: 16px;
        font-weight: 600;
        color: #333;
      }
      .history-time {
        font-size: 12px;
        color: #888;
        margin-top: 4px;
      }

      /* çŠ¶æ€æ ‡ç­¾å°åœ†ç‚¹ */
      .status-dot {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 6px;
      }
      .status-dot.success {
        background-color: #2e7d32;
      }
      .status-dot.failed {
        background-color: #c62828;
      }
      .status-text {
        font-size: 13px;
        font-weight: 600;
        text-transform: uppercase;
        color: #555;
      }

      /* æŠ˜å è¯¦æƒ…åŒºåŸŸ */
      .history-details {
        display: none;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #e0e0e0;
        cursor: default;
      }
      /* å±•å¼€æ—¶çš„æ ·å¼ */
      .history-item.expanded .history-details {
        display: block;
        animation: slideDown 0.3s ease;
      }
      .history-item.expanded {
        background: #fff;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .meta-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        font-size: 13px;
        color: #555;
        margin-bottom: 10px;
      }

      /* æ–‡ä»¶é“¾æ¥å’Œé¢„è§ˆæŒ‰é’® */
      .history-files {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 12px;
      }
      .file-action-group {
        display: inline-flex;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        overflow: hidden;
      }

      .file-btn {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        background: white;
        padding: 6px 12px;
        text-decoration: none;
        color: #667eea;
        font-size: 13px;
        transition: all 0.2s;
        border: none;
        cursor: pointer;
        height: 100%;
      }
      .file-btn:hover {
        background: #f0f4ff;
      }
      .file-btn.download {
        border-right: 1px solid #e0e0e0;
      }
      .file-btn svg {
        width: 14px;
        height: 14px;
      }

      .error-message {
        background: #ffebee;
        color: #c62828;
        padding: 10px;
        border-radius: 6px;
        margin-top: 10px;
        font-size: 13px;
      }

      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #666;
      }
      .empty-state svg {
        width: 80px;
        height: 80px;
        margin-bottom: 20px;
        opacity: 0.3;
      }

      /* æ¨¡æ€æ¡† (PDFé¢„è§ˆ) */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 2000;
        display: none;
        justify-content: center;
        align-items: center;
      }
      .modal-container {
        background: white;
        width: 90%;
        height: 90%;
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      .modal-header {
        padding: 15px 20px;
        background: #f8f9fa;
        border-bottom: 1px solid #e0e0e0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .modal-title {
        font-weight: 600;
        font-size: 16px;
      }
      .close-modal {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #666;
      }
      .modal-body {
        flex: 1;
        background: #eee;
        position: relative;
      }
      .pdf-frame {
        width: 100%;
        height: 100%;
        border: none;
      }

      /* è¿æ¥çŠ¶æ€ */
      .connection-status {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 10px 15px;
        border-radius: 8px;
        font-size: 12px;
        font-weight: 600;
        z-index: 1000;
      }
      .connection-status.connected {
        background: #e8f5e9;
        color: #2e7d32;
      }
      .connection-status.disconnected {
        background: #ffebee;
        color: #c62828;
      }

      @media (max-width: 640px) {
        body {
          padding: 14px;
        }
        .header,
        .status-card,
        .history-section {
          padding: 18px;
        }
        .header h1 {
          font-size: 24px;
        }
        .status-header {
          align-items: flex-start;
          gap: 10px;
        }
        .status-actions {
          justify-content: flex-start;
        }
      }
      /* æ–°å¢ï¼šå£°éŸ³å¼€å…³æ ·å¼ */
      .sound-toggle {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: #f0f2ff;
        padding: 6px 12px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 13px;
        font-weight: 600;
        color: #5568d3;
        user-select: none;
        transition: all 0.2s;
        border: 1px solid transparent;
      }
      .sound-toggle:hover {
        background: #e0e4ff;
      }
      .sound-toggle.muted {
        background: #f5f5f5;
        color: #999;
        text-decoration: line-through;
      }
      .sound-toggle input {
        display: none;
      } /* éšè—åŸç”Ÿ checkbox */
    </style>
  </head>
  <body>
    <div class="connection-status" id="connectionStatus">è¿æ¥ä¸­...</div>

    <div class="modal-overlay" id="pdfModal">
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-title" id="pdfModalTitle">PDF é¢„è§ˆ</div>
          <button class="close-modal" onclick="closePdfPreview()">Ã—</button>
        </div>
        <div class="modal-body">
          <iframe class="pdf-frame" id="pdfFrame" src=""></iframe>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="header">
        <h1>PDF ç¿»è¯‘æœåŠ¡</h1>
        <p>å®æ—¶ç›‘æ§ç¿»è¯‘è¿›åº¦å’Œå†å²è®°å½•</p>
      </div>

      <div class="status-card">
        <div class="status-header">
          <div>
            <div class="status-title">å½“å‰ç¿»è¯‘ä»»åŠ¡</div>
            <div class="status-subtitle" id="taskStats">
              è¿›è¡Œä¸­ 0 Â· æˆåŠŸ 0 Â· å¤±è´¥ 0
            </div>
          </div>
          <div class="status-actions">
            <div class="status-actions">
              <div
                class="sound-controls"
                style="
                  display: flex;
                  gap: 8px;
                  align-items: center;
                  margin-right: 15px;
                "
              >
                <label
                  class="sound-toggle"
                  id="soundBtn"
                  title="å¼€å¯/å…³é—­æç¤ºéŸ³"
                >
                  <input type="checkbox" id="soundCheckbox" checked />
                  <span id="soundIcon">ğŸ””</span>
                  <span id="soundText">æç¤ºéŸ³</span>
                </label>

                <input
                  type="file"
                  id="soundUploadInput"
                  accept="audio/*"
                  style="display: none"
                  onchange="handleSoundUpload(this)"
                />

                <button
                  class="action-btn"
                  onclick="document.getElementById('soundUploadInput').click()"
                  title="ä¸Šä¼ è‡ªå®šä¹‰æç¤ºéŸ³"
                  style="padding: 4px 8px"
                >
                  ğŸ“‚ ä¸Šä¼ 
                </button>

                <button
                  class="action-btn"
                  onclick="resetDefaultSound()"
                  title="æ¢å¤é»˜è®¤æç¤ºéŸ³"
                  style="padding: 4px 8px"
                >
                  â†º
                </button>
              </div>

              <div class="segmented" id="taskFilter"></div>
            </div>
            <div class="segmented" id="taskFilter">
              <button class="seg-btn active" data-filter="active">
                è¿›è¡Œä¸­
              </button>
              <button class="seg-btn" data-filter="all">å…¨éƒ¨</button>
              <button class="seg-btn" data-filter="success">æˆåŠŸ</button>
              <button class="seg-btn" data-filter="failed">å¤±è´¥</button>
            </div>
            <div class="status-badge idle" id="taskCount">0 ä¸ªæ´»åŠ¨ä»»åŠ¡</div>
          </div>
        </div>

        <div class="tasks-container" id="tasksContainer">
          <div style="text-align: center; padding: 40px; color: #999">
            <p>æš‚æ— æ´»åŠ¨ä»»åŠ¡</p>
          </div>
        </div>
      </div>

      <div class="history-section">
        <div class="history-header">
          <div class="history-title">ç¿»è¯‘å†å²</div>
          <div>
            <button class="btn refresh-btn" onclick="syncHistory()">
              åˆ·æ–°
            </button>
            <button class="btn clear-btn" onclick="clearLocalHistory()">
              æ¸…ç©ºè®°å½•
            </button>
          </div>
        </div>
        <div class="history-list" id="historyList"></div>
      </div>
    </div>

    <script>
      let eventSource = null;
      let reconnectAttempts = 0;
      const maxReconnectAttempts = 5;
      let activeTasks = {}; // å­˜å‚¨æ´»åŠ¨ä»»åŠ¡çš„æ•°æ®ï¼Œkeyä¸ºtask_id
      let taskTimers = {}; // å­˜å‚¨æ¯ä¸ªä»»åŠ¡çš„è®¡æ—¶å™¨
      let currentTaskFilter = "active";

      // ================= å…¨å±€å˜é‡åŒº =================
      // 1. ç”¨äºè®°å½•å·²æ’­æ”¾æç¤ºéŸ³çš„ä»»åŠ¡IDï¼Œé˜²æ­¢é‡å¤æ’­æ”¾
      const notifiedTaskIds = new Set();

      // 2. çœŸå®çš„é»˜è®¤æç¤ºéŸ³ (çŸ­ä¿ƒçš„ Glass Ping)
      const DEFAULT_DING_SOUND =
        "data:audio/mp3;base64,//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uQxAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq";

      // ä¼˜å…ˆè¯»å–æœ¬åœ°å­˜å‚¨çš„ç”¨æˆ·è‡ªå®šä¹‰å£°éŸ³
      let currentSoundSrc =
        localStorage.getItem("pdf2zh_custom_sound") || DEFAULT_DING_SOUND;
      let audioObj = new Audio(currentSoundSrc);
      let isSoundMuted = localStorage.getItem("pdf2zh_sound_muted") === "true";

      // ================= å£°éŸ³æ§åˆ¶å‡½æ•° =================

      // åˆå§‹åŒ–å£°éŸ³æ§ä»¶
      function initSoundControl() {
        const checkbox = document.getElementById("soundCheckbox");
        const btn = document.getElementById("soundBtn");
        const icon = document.getElementById("soundIcon");
        const text = document.getElementById("soundText");

        // è®¾ç½®åˆå§‹çŠ¶æ€
        checkbox.checked = !isSoundMuted;
        updateSoundUI();

        checkbox.addEventListener("change", (e) => {
          isSoundMuted = !e.target.checked;
          localStorage.setItem("pdf2zh_sound_muted", isSoundMuted);
          updateSoundUI();
          if (!isSoundMuted) playDing(true); // è¯•å¬
        });

        function updateSoundUI() {
          if (isSoundMuted) {
            btn.classList.add("muted");
            icon.textContent = "ğŸ”•";
            text.textContent = "å·²é™éŸ³";
          } else {
            btn.classList.remove("muted");
            icon.textContent = "ğŸ””";
            text.textContent = "æç¤ºéŸ³";
          }
        }
      }

      // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
      function handleSoundUpload(input) {
        const file = input.files[0];
        if (!file) return;

        // é™åˆ¶æ–‡ä»¶å¤§å° (æœ€å¤§ 500KBï¼Œé˜²æ­¢ LocalStorage çˆ†æ»¡)
        if (file.size > 500 * 1024) {
          alert("âš ï¸ éŸ³é¢‘æ–‡ä»¶è¿‡å¤§ï¼è¯·ä¸Šä¼ å°äº 500KB çš„æ–‡ä»¶ã€‚");
          return;
        }

        const reader = new FileReader();
        reader.onload = function (e) {
          const base64Audio = e.target.result;
          try {
            // å­˜å…¥ LocalStorage
            localStorage.setItem("pdf2zh_custom_sound", base64Audio);
            // æ›´æ–°å½“å‰éŸ³é¢‘å¯¹è±¡
            currentSoundSrc = base64Audio;
            audioObj = new Audio(currentSoundSrc);
            // æç¤ºæˆåŠŸå¹¶è¯•å¬
            alert("âœ… è‡ªå®šä¹‰æç¤ºéŸ³è®¾ç½®æˆåŠŸï¼");
            if (!isSoundMuted) playDing(true);
          } catch (err) {
            alert("âŒ ä¿å­˜å¤±è´¥ï¼šæµè§ˆå™¨å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œè¯·å°è¯•æ›´å°çš„æ–‡ä»¶ã€‚");
            console.error(err);
          }
        };
        reader.readAsDataURL(file);
      }

      // æ¢å¤é»˜è®¤å£°éŸ³
      function resetDefaultSound() {
        if (confirm("ç¡®å®šè¦æ¢å¤é»˜è®¤çš„ 'å®' å£°å—ï¼Ÿ")) {
          localStorage.removeItem("pdf2zh_custom_sound");
          currentSoundSrc = DEFAULT_DING_SOUND;
          audioObj = new Audio(currentSoundSrc);
          if (!isSoundMuted) playDing(true);
        }
      }

      // æ’­æ”¾å£°éŸ³ (force = true ç”¨äºè¯•å¬)
      function playDing(force = false) {
        if (!isSoundMuted || force) {
          audioObj.currentTime = 0;
          audioObj
            .play()
            .catch((e) => console.log("æ’­æ”¾è¢«æµè§ˆå™¨æ‹¦æˆªï¼Œéœ€è¦ç”¨æˆ·äº¤äº’:", e));
        }
      }

      // ================= å·¥å…·å‡½æ•° =================

      function formatTime(isoString) {
        if (!isoString) return "-";
        const date = new Date(isoString);
        return date.toLocaleString("zh-CN", {
          year: "numeric",
          month: "2-digit",
          day: "2-digit",
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
        });
      }

      function calculateDuration(startTime, endTime) {
        if (!startTime || !endTime) return "-";
        const start = new Date(startTime);
        const end = new Date(endTime);
        const diff = Math.floor((end - start) / 1000);
        return formatDuration(diff);
      }

      function formatDuration(seconds) {
        const m = Math.floor(seconds / 60);
        const s = seconds % 60;
        return `${m}åˆ†${s.toString().padStart(2, "0")}ç§’`;
      }

      // ================= æ ¸å¿ƒåŠŸèƒ½ï¼šå¤šä»»åŠ¡è®¡æ—¶å™¨ =================

      function updateTaskTimer(taskId, startTimeStr) {
        // æ¸…é™¤è¯¥ä»»åŠ¡çš„æ—§è®¡æ—¶å™¨
        if (taskTimers[taskId]) {
          clearInterval(taskTimers[taskId]);
        }

        if (!startTimeStr) return;

        const startTime = new Date(startTimeStr).getTime();
        const elapsedSpan = document.getElementById(`elapsedTime-${taskId}`);

        if (!elapsedSpan) return;

        // ç«‹å³æ›´æ–°ä¸€æ¬¡
        const now = Date.now();
        elapsedSpan.textContent = formatDuration(
          Math.floor((now - startTime) / 1000),
        );

        // å¯åŠ¨è®¡æ—¶å™¨
        taskTimers[taskId] = setInterval(() => {
          const currentNow = Date.now();
          elapsedSpan.textContent = formatDuration(
            Math.floor((currentNow - startTime) / 1000),
          );
        }, 1000);
      }

      function stopTaskTimer(taskId) {
        if (taskTimers[taskId]) {
          clearInterval(taskTimers[taskId]);
          delete taskTimers[taskId];
        }
      }

      // ================= æ ¸å¿ƒåŠŸèƒ½ï¼šPDF é¢„è§ˆ =================

      function openPdfPreview(url, filename) {
        const modal = document.getElementById("pdfModal");
        const frame = document.getElementById("pdfFrame");
        const title = document.getElementById("pdfModalTitle");

        // é˜»æ­¢äº‹ä»¶å†’æ³¡ (é˜²æ­¢è§¦å‘æŠ˜å /å±•å¼€)
        if (window.event) window.event.stopPropagation();

        title.textContent = "é¢„è§ˆ: " + filename;
        frame.src = url;
        modal.style.display = "flex";
      }

      function closePdfPreview() {
        const modal = document.getElementById("pdfModal");
        const frame = document.getElementById("pdfFrame");
        modal.style.display = "none";
        frame.src = ""; // æ¸…ç©º iframe é‡Šæ”¾èµ„æº
      }

      // ç‚¹å‡»é®ç½©å±‚å…³é—­
      document
        .getElementById("pdfModal")
        .addEventListener("click", function (e) {
          if (e.target === this) {
            closePdfPreview();
          }
        });

      // ================= æ ¸å¿ƒåŠŸèƒ½ï¼šå†å²è®°å½•ç®¡ç† (LocalStorage) =================

      const STORAGE_KEY = "pdf2zh_history_v2";

      function getLocalHistory() {
        try {
          return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
        } catch (e) {
          return [];
        }
      }

      function saveLocalHistory(history) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
      }

      function clearLocalHistory() {
        if (confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æœ¬åœ°å†å²è®°å½•å—ï¼Ÿ")) {
          localStorage.removeItem(STORAGE_KEY);
          displayHistory([]);
        }
      }

      // å°†æ–°çš„æ¡ç›®åˆå¹¶åˆ°æœ¬åœ°å­˜å‚¨ (å»é‡)
      function mergeHistory(serverHistory) {
        let local = getLocalHistory();

        // ç®€å•çš„å»é‡ç­–ç•¥ï¼šåŸºäº (fileName + startTime)
        const localMap = new Map();
        local.forEach((item) =>
          localMap.set(item.fileName + item.startTime, item),
        );

        serverHistory.forEach((item) => {
          const key = item.fileName + item.startTime;
          localMap.set(key, item); // æœåŠ¡å™¨æ•°æ®è¦†ç›–æœ¬åœ°ï¼ˆå› ä¸ºæœåŠ¡å™¨å¯èƒ½æœ‰æ›´æ–°çš„çŠ¶æ€ï¼‰
        });

        // è½¬å›æ•°ç»„å¹¶æŒ‰æ—¶é—´å€’åº
        const merged = Array.from(localMap.values()).sort((a, b) => {
          return new Date(b.startTime) - new Date(a.startTime);
        });

        saveLocalHistory(merged);
        return merged;
      }

      // åˆ‡æ¢å†å²æ¡ç›®æŠ˜å /å±•å¼€
      function toggleHistoryItem(element) {
        element.classList.toggle("expanded");
      }

      // ================= ç•Œé¢æ›´æ–°é€»è¾‘ =================

      function normalizeTaskState(task) {
        const rawStatus = (task.status || "").toString();
        const isActive = !!task.active;
        if (isActive)
          return { state: "active", badgeText: "ç¿»è¯‘ä¸­", badgeClass: "active" };

        const lowered = rawStatus.toLowerCase();
        if (
          rawStatus === "å®Œæˆ" ||
          rawStatus === "ç¿»è¯‘æˆåŠŸ" ||
          lowered === "success"
        ) {
          return {
            state: "success",
            badgeText: "æˆåŠŸ",
            badgeClass: "completed",
          };
        }
        if (
          rawStatus === "å¤±è´¥" ||
          rawStatus === "ç¿»è¯‘å¤±è´¥" ||
          rawStatus === "æŠ¥é”™" ||
          lowered === "failed" ||
          lowered === "error"
        ) {
          return { state: "failed", badgeText: "å¤±è´¥", badgeClass: "failed" };
        }
        return {
          state: "idle",
          badgeText: rawStatus || "ç­‰å¾…ä¸­",
          badgeClass: "",
        };
      }

      function sortTasks(tasks) {
        // é»˜è®¤æŒ‰ï¼šè¿›è¡Œä¸­ä¼˜å…ˆï¼Œå…¶æ¬¡æŒ‰å¼€å§‹æ—¶é—´å€’åºï¼ˆæ–°ä»»åŠ¡åœ¨ä¸Šï¼‰
        return tasks.slice().sort((a, b) => {
          const aa = a.active ? 0 : 1;
          const bb = b.active ? 0 : 1;
          if (aa !== bb) return aa - bb;
          const at = a.startTime ? new Date(a.startTime).getTime() : 0;
          const bt = b.startTime ? new Date(b.startTime).getTime() : 0;
          return bt - at;
        });
      }

      function filterTasks(tasks) {
        if (currentTaskFilter === "all") return tasks;
        if (currentTaskFilter === "active")
          return tasks.filter((t) => !!t.active);
        if (currentTaskFilter === "success")
          return tasks.filter((t) => normalizeTaskState(t).state === "success");
        if (currentTaskFilter === "failed")
          return tasks.filter((t) => normalizeTaskState(t).state === "failed");
        return tasks;
      }

      function updateTasks(tasksList) {
        lastTasksList = Array.isArray(tasksList) ? tasksList : [];
        const tasksContainer = document.getElementById("tasksContainer");
        const taskCount = document.getElementById("taskCount");
        const taskStats = document.getElementById("taskStats");

        // æ›´æ–°ä»»åŠ¡è®¡æ•°
        const activeTaskCount = tasksList.filter((t) => !!t.active).length;
        const successCount = tasksList.filter(
          (t) => normalizeTaskState(t).state === "success",
        ).length;
        const failedCount = tasksList.filter(
          (t) => normalizeTaskState(t).state === "failed",
        ).length;
        taskCount.textContent = `${activeTaskCount} ä¸ªæ´»åŠ¨ä»»åŠ¡`;
        taskCount.className = `status-badge ${activeTaskCount > 0 ? "active" : "idle"}`;
        taskStats.textContent = `è¿›è¡Œä¸­ ${activeTaskCount} Â· æˆåŠŸ ${successCount} Â· å¤±è´¥ ${failedCount}`;

        const sorted = sortTasks(tasksList);
        const shown = filterTasks(sorted);

        if (shown.length === 0) {
          tasksContainer.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #999;">
                        <p>æš‚æ— ç¬¦åˆç­›é€‰æ¡ä»¶çš„ä»»åŠ¡</p>
                    </div>`;
        } else {
          // ä¸ºæ¯ä¸ªä»»åŠ¡åˆ›å»ºå¡ç‰‡
          tasksContainer.innerHTML = shown
            .map((task) => {
              const taskId = task.taskId || "unknown";
              const isActive = !!task.active;
              const normalized = normalizeTaskState(task);
              let progress = Number.isFinite(task.progress)
                ? task.progress
                : parseInt(task.progress || "0", 10);
              if (!Number.isFinite(progress)) progress = 0;
              if (normalized.state === "success") progress = 100;

              // ç¡®å®šå¡ç‰‡æ ·å¼
              let cardClass = "task-card";
              let badgeClass = "task-badge";
              let badgeText = normalized.badgeText;
              if (normalized.state === "active") {
                badgeClass += " active";
                updateTaskTimer(taskId, task.startTime);
              } else if (normalized.state === "success") {
                cardClass += " completed";
                badgeClass += " completed";
                stopTaskTimer(taskId);
              } else if (normalized.state === "failed") {
                cardClass += " failed";
                badgeClass += " failed";
                stopTaskTimer(taskId);
              } else {
                stopTaskTimer(taskId);
              }

              // è®¡ç®—è€—æ—¶
              let elapsedText = "-";
              if (task.startTime) {
                if (isActive) {
                  elapsedText = `<span id="elapsedTime-${taskId}">è®¡ç®—ä¸­...</span>`;
                } else {
                  const end = task.endTime
                    ? new Date(task.endTime)
                    : new Date();
                  const start = new Date(task.startTime);
                  const diff = Math.floor((end - start) / 1000);
                  elapsedText = formatDuration(diff);
                }
              }

              // æ¶ˆæ¯æ¡†
              let messageHtml = "";
              if (task.message) {
                let msgClass = "task-message";
                if (normalized.state === "failed") msgClass += " error";
                else if (normalized.state === "success") msgClass += " success";
                messageHtml = `<div class="${msgClass}" style="display: block;">${task.message}</div>`;
              }

              return `
                    <div class="${cardClass}" id="task-${taskId}">
                        <div class="task-header">
                            <div class="task-filename">${task.fileName || "æœªçŸ¥æ–‡ä»¶"}</div>
                            <div class="${badgeClass}">${badgeText}</div>
                        </div>

                        <div class="task-progress-bar">
                            <div class="task-progress-fill" style="width: ${progress}%"></div>
                        </div>

                        <div class="task-info">
                            <div class="task-info-item">
                                <div class="task-info-label">è¿›åº¦</div>
                                <div class="task-info-value">${progress}%</div>
                            </div>
                            <div class="task-info-item">
                                <div class="task-info-label">å¼€å§‹</div>
                                <div class="task-info-value">${formatTime(task.startTime)}</div>
                            </div>
                            <div class="task-info-item">
                                <div class="task-info-label">å¼•æ“</div>
                                <div class="task-info-value">${task.engine || "-"}</div>
                            </div>
                            <div class="task-info-item">
                                <div class="task-info-label">æœåŠ¡</div>
                                <div class="task-info-value">${task.service || "-"}</div>
                            </div>
                            <div class="task-info-item">
                                <div class="task-info-label">è€—æ—¶</div>
                                <div class="task-info-value">${elapsedText}</div>
                            </div>
                        </div>

                        ${messageHtml}
                    </div>
                `;
            })
            .join("");
        }

        // === æ ¸å¿ƒé€»è¾‘ï¼šæ’­æ”¾æç¤ºéŸ³ä¸å†å²åˆ·æ–° ===
        tasksList.forEach((task) => {
          const taskId = task.taskId;
          const st = normalizeTaskState(task).state;

          // åªæœ‰å½“ä»»åŠ¡ ä¸æ´»è·ƒ(å®Œæˆ) ä¸” çŠ¶æ€æ˜¯æˆåŠŸæˆ–å¤±è´¥ æ—¶æ‰å¤„ç†
          if (!task.active && (st === "success" || st === "failed")) {
            // å¦‚æœè¿™ä¸ªIDè¿˜æ²¡å“è¿‡ï¼Œå°±å“ä¸€æ¬¡
            if (!notifiedTaskIds.has(taskId)) {
              console.log(`âœ… ä»»åŠ¡å®Œæˆï¼Œè§¦å‘é€šçŸ¥: ${task.fileName}`);
              playDing();
              notifiedTaskIds.add(taskId); // æ ‡è®°ä¸ºå·²é€šçŸ¥

              // å»¶è¿Ÿåˆ·æ–°å†å²è®°å½•
              setTimeout(syncHistory, 1500);
            }
          }
        });

        // æ›´æ–°æœ¬åœ°ä»»åŠ¡ç¼“å­˜ (ç”¨äº SSE æ–­è¿é‡è¿åçš„çŠ¶æ€æ¯”å¯¹ç­‰ï¼Œè™½ç„¶åœ¨è¿™é‡Œæœ‰äº† notifiedTaskIdsï¼Œè¿™ä¸ªç”¨é€”å˜å°äº†ï¼Œä½†ä¿ç•™ç€ä¹Ÿæ²¡åå¤„)
        activeTasks = {};
        tasksList.forEach((task) => {
          activeTasks[task.taskId] = task;
        });
      }

      // ================= SSE è¿æ¥ =================

      function connectSSE() {
        if (eventSource) eventSource.close();

        eventSource = new EventSource("/events");

        eventSource.onopen = function () {
          console.log("SSEè¿æ¥æˆåŠŸ");
          document.getElementById("connectionStatus").className =
            "connection-status connected";
          document.getElementById("connectionStatus").textContent = "â— å·²è¿æ¥";
          reconnectAttempts = 0;
        };

        eventSource.onmessage = function (event) {
          try {
            const data = JSON.parse(event.data);
            if (data.type === "tasks") {
              updateTasks(data.data);
            }
          } catch (e) {
            console.error("SSEè§£æé”™è¯¯:", e);
          }
        };

        eventSource.onerror = function () {
          document.getElementById("connectionStatus").className =
            "connection-status disconnected";
          document.getElementById("connectionStatus").textContent = "â— æœªè¿æ¥";
          eventSource.close();
          // åœæ­¢æ‰€æœ‰ä»»åŠ¡çš„è®¡æ—¶å™¨
          Object.keys(taskTimers).forEach((taskId) => stopTaskTimer(taskId));

          reconnectAttempts++;
          if (reconnectAttempts < maxReconnectAttempts) {
            setTimeout(connectSSE, 3000);
          }
        };
      }

      // ================= å†å²è®°å½•æ¸²æŸ“ =================

      async function syncHistory() {
        try {
          // 1. è·å–æœåŠ¡å™¨å½“å‰ä¼šè¯çš„å†å²
          const response = await fetch("/api/history");
          const result = await response.json();

          let mergedHistory = [];
          if (result.status === "success") {
            // 2. ä¸æœ¬åœ°å­˜å‚¨åˆå¹¶ (æŒä¹…åŒ–)
            mergedHistory = mergeHistory(result.history);
          } else {
            // å¦‚æœæœåŠ¡å™¨å‡ºé”™ï¼Œè‡³å°‘æ˜¾ç¤ºæœ¬åœ°çš„
            mergedHistory = getLocalHistory();
          }

          displayHistory(mergedHistory);
        } catch (error) {
          console.error("åŒæ­¥å†å²è®°å½•å¤±è´¥:", error);
          // ç½‘ç»œé”™è¯¯æ—¶ï¼Œå›é€€åˆ°æœ¬åœ°è®°å½•
          displayHistory(getLocalHistory());
        }
      }

      function displayHistory(history) {
        const historyList = document.getElementById("historyList");

        if (!history || history.length === 0) {
          historyList.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <p>æš‚æ— ç¿»è¯‘è®°å½•</p>
                    </div>`;
          return;
        }

        historyList.innerHTML = history
          .map((item, index) => {
            const isSuccess = item.status === "success";
            const statusClass = isSuccess ? "success" : "failed";
            const statusText = isSuccess ? "æˆåŠŸ" : "å¤±è´¥";
            const duration = calculateDuration(item.startTime, item.endTime);
            const timeStr = formatTime(item.startTime);

            // ç”Ÿæˆæ–‡ä»¶æŒ‰é’® HTML
            let filesHtml = "";
            if (isSuccess && item.fileList && item.fileList.length > 0) {
              filesHtml = `
                        <div class="history-files" onclick="event.stopPropagation()">
                            ${item.fileList
                              .map((file) => {
                                const url = `/translatedFile/${encodeURIComponent(file)}`;
                                return `
                                <div class="file-action-group">
                                    <a href="${url}" class="file-btn download" download title="ä¸‹è½½æ–‡ä»¶">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                        </svg>
                                        ä¸‹è½½
                                    </a>
                                    <button onclick="openPdfPreview('${url}?preview=true', '${file}')" class="file-btn preview" title="åœ¨çº¿é¢„è§ˆ">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            <path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                        </svg>
                                        é¢„è§ˆ
                                    </button>
                                </div>`;
                              })
                              .join("")}
                        </div>`;
            }

            // é”™è¯¯ä¿¡æ¯ HTML
            let errorHtml = "";
            if (!isSuccess && item.error) {
              errorHtml = `<div class="error-message"><strong>é”™è¯¯ä¿¡æ¯:</strong> ${item.error}</div>`;
            }

            return `
                <div class="history-item ${statusClass}" onclick="toggleHistoryItem(this)">
                    <div class="history-summary">
                        <div>
                            <div class="history-filename">${item.fileName || "æœªçŸ¥æ–‡ä»¶"}</div>
                            <div class="history-time">${timeStr}</div>
                        </div>
                        <div style="display:flex; align-items:center;">
                            <span class="status-dot ${statusClass}"></span>
                            <span class="status-text">${statusText}</span>
                        </div>
                    </div>
                    
                    <div class="history-details">
                        <div class="meta-grid">
                            <div><strong>å¼•æ“:</strong> ${item.engine || "-"}</div>
                            <div><strong>æœåŠ¡:</strong> ${item.service || "-"}</div>
                            <div><strong>è€—æ—¶:</strong> ${duration}</div>
                            <div><strong>ç»“æŸ:</strong> ${formatTime(item.endTime)}</div>
                        </div>
                        ${filesHtml}
                        ${errorHtml}
                    </div>
                </div>`;
          })
          .join("");
      }

      // ================= åˆå§‹åŒ– =================

      window.addEventListener("load", function () {
        // ä»»åŠ¡ç­›é€‰æŒ‰é’®
        const filterEl = document.getElementById("taskFilter");
        if (filterEl) {
          filterEl.addEventListener("click", (e) => {
            const btn = e.target.closest("button[data-filter]");
            if (!btn) return;
            currentTaskFilter = btn.dataset.filter;
            Array.from(filterEl.querySelectorAll(".seg-btn")).forEach((b) =>
              b.classList.remove("active"),
            );
            btn.classList.add("active");
            // ç«‹åˆ»ç”¨æœ€è¿‘ä¸€æ¬¡ SSE æ•°æ®é‡ç»˜ä»»åŠ¡åˆ—è¡¨
            updateTasks(lastTasksList);
          });
        }

        // å…ˆåŠ è½½æœ¬åœ°å­˜å‚¨çš„å†å²ï¼ˆæ­¤æ—¶æ— éœ€ç­‰å¾…æœåŠ¡å™¨ï¼‰
        displayHistory(getLocalHistory());

        // å»ºç«‹è¿æ¥
        connectSSE();

        // å°è¯•ä»æœåŠ¡å™¨åŒæ­¥æœ€æ–°å†å²
        syncHistory();
        initSoundControl();
      });

      window.addEventListener("beforeunload", function () {
        if (eventSource) eventSource.close();
        // æ¸…ç†æ‰€æœ‰è®¡æ—¶å™¨
        Object.keys(taskTimers).forEach((taskId) => stopTaskTimer(taskId));
      });
    </script>
  </body>
</html>
